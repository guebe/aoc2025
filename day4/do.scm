(import (srfi 1))

(define example '(
"..@@.@@@@."
"@@@.@.@.@@"
"@@@@@.@.@@"
"@.@@@@..@."
"@@.@@@@.@@"
".@@@@@@@.@"
".@.@.@.@@@"
"@.@@@.@@@@"
".@@@@@@@@."
"@.@.@@@.@."
))

(define input '(
"@.@@@@.@@.@@@@.@@.@@@@@..@@@@@..@@.@@..@@@.@@@@@@@@...@@..@@@.@@@.....@@@@@..@@.@@@@@.@..@.@@.@@@@.@@@@@@..@..@.@@@@@..@@@.@@.@@...@@.@"
"@..@@@@@.@@@@.....@@..@@@@.@@@@.@.@.@.@@@@@@@.@@@.@@.@@..@.@@@.@.@.@@@.@@@@@.@...@@.@@@..@@..@.@@@@.@.@@@@.@.@@..@@@@.@@....@@.@@@@@@@@"
"@.@.@.@...@.@@@@@@..@.@@..@@@@@..@@..@...@@@.@@@@.@@@@@@@.@@@@@.@@@@@.@@@@@@@@@.@@@.@@@@@@@.@@@@@...@@.@@@.@@@.@@@.@@...@@@.@@.@.@@.@.."
".@@@@@@@..@@@.@@@@@@@@@@.@@.@@@@@@.@@.@.@..@@@@@@.@.@.@@..@@@.@.@@@@.@.@@@@@@@.@.@@..@.@.@@@@.@@.@@@@@@@@@@@@@@@.@.@@@.@@@@@.@.@..@.@@@"
"@@@@@@@....@@...@@.@...@..@@.@@.@@..@@@@@@@@.@.@@.@.@.@.@.@.@@@@.@.@@@..@@..@..@@.@@..@@@.@.@@@@.@...@@@.@@.@@@..@@@@@@@.@@@@@@@@.@.@@."
"@.@..@..@@.@@@@@@@.@@@@@@.@@@.@..@@@@@@.@@@.@@@@@.@..@@...@..@..@.@@.@@..@@@@@@@@@...@@@.@@.@@@@@.@..@@@@@@.@@.@@@..@.@@@@.@.@......@.@"
"@....@...@.@...@@@.@.@@@.@.@@@.@@.@..@.@.@.@@@.@@.@..@.@...@.@@@@@@@@@@@@..@@.@@@@.@.@.@@@@@....@@.@@..@@@.@@.@@...@@@.@.@@....@.@..@.@"
".@@.@@@@..@...@@@..@@@..@@@@@@...@@@@@@@@@@.@@.@.@.@@@.@.@@@@@@@@.@@.@@@..@@@@.@@@@..@@@@@@.@@@@@@@..@...@@@@.@@.@@..@@@@@@@@@@@@@.@@.."
"@@..@@...@@@.@@@..@@@@@@@.@@@@...@@@@@@@...@@@@.@.@.@.@@.@@.@..@.@@.@@@@..@@@@@@@@.@@@@@...@@@@....@@@.@@...@.@....@@@@@...@@@@@@..@@@@"
"@@.@..@@@.@@@.@.@@@@@@@@@..@@@@.@.@@.....@@.@@@..@.@@@.@@@@@.@.@@@@@..@@@@@@.....@..@@@@@@@@.@.@@@.@..@@..@..@..@@@@@.@@.@@@.@@.@@@@.@@"
"@@.@@.@.@@@.@..@.@@@.@@...@@.@@@@@@@.@@..@@@@@@@@@.@@.@@.@.@@@@@..@@@..@@@@@..@@@@..@@..@..@@@@@@.@@..@@..@...@@..@@@@..@@@.@.@@@.@..@."
"@@@@@@.@@..@.@.@@@@.@@.@@@@.@..@.@....@@@.@@@@@.@@@@@@.@@@@@@@@@@@..@@@@....@@..@..@.@@..@@@@..@@.@@.@@@@@@@@@..@@...@@..@....@@@@....."
"@@@@@@@@@@.@@@.@@..@@.@@.@.@.@.....@@.@.@@@.@@..@@@@@@@@.@@@@.@.@.@.@@.@@.@@..@@...@.@@@@@@@@@@..@@@...@@@@...@..@.@@@@.@...@.@@@@@...."
"..@@@@@@@...@@..@..@@@@.@@..@@.@@.@@@.@@@@@@@@@..@@.@@@@.@@@@@@@@.@@....@@.@@.@@@@@@@....@@@.@@@.@@@@@.@@.@..@@@@.@@@@.@.@.@...@..@.@@@"
"@@....@@@@@@.@.@@@@@@@@@.@@@.@@@.@@@.@@@.@@@@@.@@.@@.@.@@@@@..@.@@@@.@...@.@@@@@.@@.@.@@@.@..@@@@...@@@@...@...@.@@....@.@@@.@.@..@@..@"
"..@@.@.....@@.@@@@@@@.@@@@.@@@@.@@@@@@..@@.....@..@@@@@@@.@..@@@@.@@...@.@.@.@.@..@@.@.@.@@@@@.@@@.@.@..@@.@@@.@@.@..@@.@@@@@@@@@@@@..."
".@.@@@@@@.@@@@@@@@@@@..@.@.@.@@..@@.@@.@.@@@@.@...@@@@@..@@@.@@.@@@@.@@@@.@.@@@@@@@@@.@@.@@.@@@..@.@.@@@@@@...@@@..@@@@@@.@@@@@@.@@@..@"
"@.@.@..@.@@@@.@.@.@@@@@@@....@@@@@@@@@.@@@@@.@@.@..@..@@@@@@@@@....@..@@@@@.@.@@...@@@@@@.@@..@@.@.@@@@@.@@@@.@@@@.@@.@@.@@.@@@@.@@@@@."
"@@@@@@@.@@@@@@@@.@@@.@.@@@@@.@@.@@@@@@@@@.@@@@@@@@@@@@@@@@@@@.@@.@@.@.@@@@@.@@.@@@.@...@@@.....@@@@@.@@.@.@@@@.@@@@@@.@.@@@.@.@@@..@.@@"
"@@@@@.@.@.@@.@@@@@.@.....@@@@..@@@@.@...@@@.@@..@.@@.@@@..@..@.@@@@@@.@@@@@@@@@.@@@@.@@@@@@....@@.@.@@@...@...@..@...@..@..@@@@@.@..@@@"
"@@@@@@@@@@@@..@@@.@@@@@@.@@@@@..@.@.@@@@...@@@@.@.@@@..@..@@@@.@@...@..@..@@@@@@@@@.@..@.@@@.@@@@@@.@@@.@.@@@.@.@@..@@@....@@@@@@@@@@@@"
"@@....@@..@@@.@@@.@.@@.@@@@@@.@.@@@@..@@@@@@..@..@@.@@@@@@@@@@.@.@@.@@@..@@@@...@@@@..@@@.@@.@@..@@@@.@.@@.@@.@@@@.@.@@@@@.@@@...@@@@@@"
"@@@@.@.@.@@@@.@.@@@@@..@..@..@.@@.@@@..@@.@@@@@.@@.@@@..@.@@@.@@...@@.@@.@..@@@@.@@@.@@....@@@@.@@@@@@@.@@.@..@.@@.@..@@..@.@@.@..@@@.."
"@@.@..@@@.@..@.@..@@.@..@@@@@.@@@.@@.@.@.@@...@.@@@..@@.@@@.@@....@.@.@@..@@@@@...@@.@@@@@@.@@...@.@@@..@.@@@@@@@@@@@..@@...@@.@@@@@@@@"
".@@@@...@.@..@...@@..@@@.@@@..@@@@...@.@@@@.@@.@.@.@@..@@.@.@.@@@@.@@@@@@..@.@@..@@@@@@@@..@@.@@..@...@@.@@@.@@@@.....@.@@@@@.@.@@..@@@"
".@@.@...@.@@.@@.@@.@.@...@@@@@@@@@..@@@.@@@........@@@@.@..@@.@@@.@@@@@..@@.@.@..@@@@@.@@@@@@@.@@.@.@@@@@@.@@.@.@..@.@@.@..@.@@@@@@@.@@"
"@@...@.@@...@@@@@@...@..@@@@@@.@@@.@@@@@.@..@@..@@@@@@@..@@@..@.@@.@@@.@.@.@..@@@@@@@.@@@@@@@@.@@@@@@@@.@.@@@@@.@..@@.@@@@@@@@.@@@@@.@."
"@.@@.@@@.@@@@.@@@@..@@@..@@@@.@@.@@..@@@@@@@....@@@.@..@@@.@@.@@@@@@..@@@@@@@@@@@.@@@@@@@@@@..@@.@.@@..@@@.@@@@@@..@@@.@@..@@@.@.@..@.@"
"@@@.@@.@.@@..@..@@@@..@@...@.@@.@@@@.@@@@.@@@@.@@.@.@@..@@.@...@..@@.@@@@...@@..@.@.@@..@@@.@@@@@.@@.@.@@..@...@..@...@.@@@.@.@@.@.@.@."
"@.@.@.@@@@@...@@.@..@@@@...@@@..@.@@..@.@.@@@@.@@..@@@@@..@@@..@..@@.@@.@@@@@@@@.@@.@@..@.@....@@@.@@@@..@@@@@..@.@@.@.@..@@@@@.@@@.@@@"
"@@@.@@.@@@@@@@.@.@@@..@...@@.@@@@@@@@@@.@.@.@@.@@@.@@@@.@..@@@@@@@@.@@@@@...@@@.@@@..@@.@...@.@@@@.@.@@...@.@@@@@.@@@.@.@@@@.@.@@@@@@@@"
"@@@@..@@@@.@@@@@.@.@@@@.@@@@..@.@..@@@@..@@@.@@@.@@@@@@@@@@@.@@@@.@@@@@@@.@@@.@@.@@@@@..@@@@@@.@@@@....@@...@@@.@.@@@...@@.@@@@.....@.@"
"@@@@@.@.@.@..@@@@@@@@@@@@..@@.@.@@@@.@@@.....@@.@@@@.@@..@@.@@@.@@@@@@@@.@.@@.@@@@.@@..@@@@@@.@@@@.@@.@@@...@@@.@@.@.@@@@@@@.@.@@@@@.@."
".@.@@@@.@.@@..@@@@.@@@.@@@@@@.@@@@.@...@....@@@...@.....@@.@.@@@..@@..@@@.@@.@@@@...@..@@.@.@@@..@.@...@.@@...@@.@@@@.@.@..@@@@.@...@@@"
"@.@@@..@@.@.@@@@@@@@@.@.@@@.@.@..@@@@.@..@.@@@.@@@.@..@@@@@@@@@.@.@.@@@.@@..@@.@@@.@@@.@..@@@@@.@.@@@..@...@@@@@..@.@@.@@@.@@@.@@.@@@@."
".@@.@@.@.@.@@@.@.@@.@@@@.@@...@@@@.@@@.@..@.@.@.@@..@.@@@...@@...@@.@@..@.@@@@.@.@@@@@.@@@@@@@.....@@@@@.@@.@@@..@@@..@.@.@.@@@@..@.@@@"
".@@.@@@@.@@..@@@@.@@.@@@@@@@@@@.@@....@.@.@.@.@@@.@@..@.@@..@.@@..@@.@@@@.@@@@@.@@@.@.@.@@.@.@@@...@.@.@....@@@@...@@@@..@.@@@@@@..@@@@"
"@..@.@.@@@@@@@.@@@@@@@@@@@@@@@@.@@@@@@.@@@@@.@@@.@@.@@.@@@@@...@@@.@@@.@@.@.@.@@@.@.@.@@.@..@.@@.@@.@@.@.@@@@@...@@.@@@@.@@.@@@@..@@.@@"
"@..@@@.@@@@@.@..@@@@@@.@@...@@@....@@@@@..@@@@..@.@..@@..@@@.@@@.@@@..@@@@@@@.@.@@@@@@@.@.@.@@..@...@..@@.@.@@@..@@.@.@@.@.@@@@..@@@@@."
".@@.@@@.@.@.@@@@.@@@.@@@@@.@@@.@@.@.@@@..@@..@@@.@...@@@.@@..@@.@@@.@@.@@..@@@@..@@@..@@@@.@@@.@@.@@@@@...@...@@@..@@..@@@.@@@@..@@@..."
"@@.@...@@@@@.@@@@@..@.@@@.@@.@@@@@...@@.@@@@..@@..@@.@@.@..@.@....@@@.@@.@.@.@.@....@@@.@@@@@@@@@@@@@@.@.@@.@..@.@...@@.@.@@.@..@@.@@.."
".@@@@@@@@@@.@.@@@@@.@@@@@@.@@.@@@@@.@.@@@.@.@@@@@@.@@.@@@@@..@@@...@@@...@@@@.@@@@@.@@.@.@@.@.@.@@@..@@.....@@@@@.@@@.@@.@@@@@@.@.@@@@."
"@@..@@.@@@@@@@@.@@@.@@@@@.@@@@@@@@.@@@@.@@@@.@..@@@@@...@.@..@@...@@.@.@@@...@@@..@.@@@@@@@@.@@@@@..@@@@.@@@@@.@@@@@.@@...@..@@...@..@@"
"@@...@@@@@.@.@@@@@@.@@@@@@@.@@.@.@.@@@@.@@@@@@@@..@@.....@..@@@.@@@....@.@.@.@@..@@.@@@.@@@@..@@.@@..@@@.@@@.@@@..@.@@..@@@@@@.@.@@@.@."
"@.@@@@@@@@....@@.@.@..@@@..@@@@..@@@..@@@@@@.@.@.@.@@@.@@@.@@...@.@@@...@@@@@@@@.@@@..@@@@@@..@@.@@@@@@.@@@...@@@@.@@....@@@.@@.@..@@.@"
"@..@.@@.@..@@@@@.@.@@@@@@.@@@@..@@..@......@.@..@@@@@@@.@.@@@@@@@@...@...@@@@.@..@@.@@@@.@@..@@@@.@@@..@@.@..@.@@.@.@@@.@@...@@@@.@@..."
".@@.@@@@@@.@@@@...@@@.@.@@.@.@.@@.@@@@.@@.@.@@..@@@@.@.@..@.@.@..@@....@@@@@@.@..@@@@.@@@@@.@@.@@@@..@@@@@@@.@...@@.@.@@@@@@..@.@@@@..@"
"@@.@@.@@@...@.@@@.@@...@.@@@@@@@@@@.@@@.@@@.@@.@@@@.@.@.@@@...@@@.@.@.@@..@.@@@.@..@@.@@@.@@@.@@@.@@.@@@@..@@.@.@@@@@..@@..@.@.@@@...@@"
"@@@.@@..@@@@@@@@.@.@@@..@@@@@.@.@.@.@@@@.@.@@@@@.@@@@.@@@@@@@@@.@@@.@@.@@@@@@@@.@@.@...@.@@@.@@.@@@@.@@@.@@@..@@@@.@..@@@.@@@..@.@.@@@@"
"@@.@@..@@.@@@@@@@@@@.@@@@.@@.@@@@@@@.@@@@@@@@@.@@....@@@@.@.@@@@.@@@.@.@@@@@@@@@@@.@.@.@.@.@@@.@@.@@.@@@@.@.@@@.@@@@@@@@@...@@@@...@..@"
"@@@@@@@@.@@@.@.@@@..@@@@.@@@@.....@.@@@.@@@@@@.@@@..@@.@@.@@@@@@.@@@@..@@@@@@@@@@.@..@.@@..@@@@@@@.@..@@@@..@@@.@@@@@....@@@..@........"
".@@@@.@...@.@@@@@@@@.@.@.@.....@@....@.@@@@..@@@.@@@@..@@@@@...@.@@@.@@@@@@@@@@@.@..@@@@.@@@@.@...@@@@@.@@@@..@@@.@@@..@@@@@.@@@@@..@@@"
".@@@@.@@@@@.@..@.@@@@.@@@@@.@@@...@....@@@@@@@@@@@@.@@@@@@@@@@@@@@@@@@@@@@.@@@@@....@@@.@@.@@..@@@.@.@@.@@@@.@@@@@.@@@...@.@@@@..@@@.@."
"@@@@.@@.@@@.@@.@@...@.@@@.@@@.@.@.@@@@@@@@.@..@...@@....@@@@.@@@.@@...@.@@@@@@@@@.@@@.@.@...@.@@@.@@..@.@@@@@@.@@@.@.@@@...@@.@@@@.@.@@"
"@@@@.@@@....@..@@@@..@@@..@.@.@...@@@@@@.@@@@@..@@@@@@.@.@.@@@@@.@@..@..@@@.@@@.@@@@.@@@.@@...@@@.@@.@..@..@..@.@@@..@@.@@..@@..@@..@@@"
".@@@@@@.@@@..@....@@@..@@@@...@@@.@@@@@.@@@@@.@@@@@@@..@@@@@@@@..@.@.@@@@@.@.@@@.@..@@@@@@@.@@.@@.@@.@@@@..@@..@@..@@..@@@@@.@@.@@@@@@@"
"@.@@@.@@.@.@...@@@@@@@..@@@@@.@.@@@.@.@.@@@@.@.@@@@@@..@.@@@@@.@@@@.@@@@@.@@.@@..@..@..@@@@@@@@@@..@@@.@.@.@@.@..@@@..@@@@@@.@@@..@.@.."
"@@@.@..@@@@.@.@@@...@@@@@@.@@@.@@@.@@@@....@@...@@.@@..@.@@.@@.@..@@@.@.@@..@@..@.@@@@...@@@@@.@@@@.@@@@.@@...@@.@@.@.@.@@@@@@@@@@@@@@@"
"@@@.@@.@@@..@.@.@@..@@@@@@.@@@@@@.@@..@.@@@@.@@@@@@@@.@@@.@.@@@@@@@@@@.@@.@@.@@.@.@@@.@...@.@@@@.@.@@@@.@.@@@@@@.@@.@@@.@@@@@@@@@@.@.@@"
"..@@@.@@@@@@@...@@..@@@@@@.@.@@@@@.@@@@.@..@@@@.@..@@@@@.@.@@@@..@.@.@.@@@@@@@@@@@@@@@..@@@..@@@@..@@@..@@.@@@.@.@..@@.@@@@@@@@@@.@@.@@"
"...@..@@@@...@@@@@@@@.@@@@.@.@@@@@....@..@..@@@@@@@@.@@@@@@@@.@@.@@@@.@@...@..@@@@@....@@@.@@.@@.@@@@@@@@.@.@.@.@@@@@@.@..@@.@@..@....."
"@@@@...@...@@@@.@...@.@.@.@.@@@@.@..@.@@@..@@@.@@@@@.@@@@.@.....@@@.@....@@..@.@@@.@@@..@@.@@.@.@@@.@@.@.@@.@@@.@..@.@@@.@@..@.@@.@..@@"
".@@.@.@@@@..@@@@@@@@.@...@..@@...@@@@@@@@@@@@@@.@@..@@@.@.@@@@...@..@.@..@@.@@@@@.@.@@@@@@..@...@@.@@@@.@@@@@@@@@@@@@@@@@@.@.@@@.@@.@@."
"@@.@..@@@@@..@@.@@@@@.@..@..@.@@.@.@@@@@.@....@@@@@.@@@@.@@@@@..@.@.@.@@@@.@@.@@@@@@@.@@..@@...@@...@.@@@@.@@.@@@@.@@@@@@@@@.@@@@@.@@@@"
".@...@@..@@.@...@..@@.@.@@.@@@@.@@..@@..@@@@...@....@@..@....@@@.@.@@.@@@@.@@.@@.@@@@@@@...@.@@@@..@.@@@@@..@@.@@.@@@.@@@@.@...@@@@@.@@"
"@@.@@@@.@.@@..@@@@.@.@...@@@.@@.@@@@@@@.@..@.@@@@@..@.@.@@@.@..@@@.@@...@@@..@.@@.@.@@.@@@..@.@@.@@@@.@@@@@@@.@.@@...@.....@.@@.@@@@.@."
"@.@.@@@.@...@@@@@@@@@.@.@@@@@@@@@..@..@@@@.@@@@.@@.@@.@@@@@@@@..@.@@@@@.@.@@@@.@@..@@@@@@.@@.@.@.@.@.@.@@@@@@@@@@.@@.@.@@@@.@.@@.@.@.@@"
"@.@@.@@.@@.@@@.@..@.@@..@@@.......@.@@..@@@.@..@@@@@.@@@@@@@..@@@@@.@@@@@..@@@@.@@@@@@..@@@@@.@...@..@@.@@@@@@@.@@@....@..@@@@@.....@@@"
"..@@@@@@@@@@@@@@@.@@@@.@@.@@@@..@@..@@@@@.@.@.@@@@..@@..@@@....@.@.@@@@@@.@@@@@@.@@.@.@@@@@...@..@@@@@..@.@@..@@@.@.@@..@@@@.@.@@@@@@@."
"@@..@@@..@@@@@@@.@@@.@..@@@@@@@@@@@.@.@@.@@...@.@@.@@@@@..@.@.@@.@..@@@..@..@@.@.@.......@..@@.@@.@@@@@.@.@...@@@..@@@..@..@@..@@.@@@.@"
"..@@.@..@.@@.@.@@@@@@@.@@...@@.@@@@.@@..@@@@@.@@@.@@@@@@.@@..@@@@@.@..@@@@@.@@.@.@@@@@.@@..@....@..@@@..@@@.@..@@.@@@@@....@@.@.@@@@@@@"
"@@@@@@@@@@.@@.@..@@.@@@.@@..@..@....@.@@@...@@@.@.@...@.@.@@@.@.@@@@.@@...@.@.@@@.@.@@@@.@@.@@@.@@@..@@@.@..@.@@...@@.@@@@@@@...@....@@"
"@@@@@.@.@@@..@@@@@..@..@@@@@@.@@..@@.@@...@@@@@@@@.@@.@.@@.@....@.@@@@@@.@@.@@..@@@@@@.@@.@.@@@.@..@@@@@.@@@..@...@@@..@@@@@@@.@.@.@@@."
"@@@.@@@@@..@....@@@@.@..@@..@.@@.@.@@@.@@.@@@@.@@@@..@@@@.@....@@@@.@@..@@@@@.@@.@@..@@@@@.@.@.@@.@@@..@@..@@@.@@@....@.@.@@.@@.@@@@@@@"
".@@@@@.@@@@.@.@@@.@@.@@@@@.@@...@.@@@@@@@...@@.@..@@@@@@@.@@....@.@@..@..@.@.@@.@@@@@@@@@@@@@..@@.@.@.@.@@@@@.@@@@@@@@@@@..@@@@@@@.@@@@"
".@@.@@@@@@.@@@...@.@@@...@.@@@@@.@@@@@.@@.@@@@@@@.@@@@.@.@@@..@@@@...@@@.@@.@@@.@@@@..@@@....@@.@@@@@.@@.@@@@.@@@@@@@@.@..@.@..@@@@.@@@"
"@...@@.@@...@@@@.@@.@@@@@@@...@@@@@@@@@@@@.@@.@.@@@@.@@..@..@...@@.@@.@.@@..@@...@@@@@..@@@@@@..@@.@@.@@..@..@..@@@@@..@@@@@@@.....@@.@"
"@@@.@@...@@@@.@...@@@..@@@.@.@@@.@..@.@....@@@.@@@.@@@@@@@..@.@..@@@.@@@@.@@@....@...@@@@@@@.@@@.@.@@@.@....@.@..@.@.@...@@..@...@@@@@."
"@@@@..@.@..@@@..@@.@..@@@@@.@@...@@@.@.@@@..@.@@@@.@.@.@@.@@...@@@.@.@@@.@@@.@@@.@@.@.....@@@@@@.@@@.@@..@..@..@.@.@.@@@@@@.@@.@@@@@@.."
"@@@@.@@.@@@@@@@@@@@..@@@.@@@@@..@@@@@@@@@@..@....@@.@...@@@.@.@.@@.@.@.@@.@@.@@@@..@.@@.@@@.@.@.@@@@@@@@@@..@..@.@.@..@@@..@@.@@@@@.@@@"
"@@@@@@@@.@.@.@@..@@@.@@@.@.@...@@@@.@@@@@@..@@@@@@@@.@@@@.@.@...@...@@..@@@@@.@@@@.@@@.@@..@@@@@.@.@..@.@@.@.@@..@..@@...@.@@...@@.@@.."
"@@@@...@@@@@.@@@..@@@@.@@..@.@@@@@@@@@@..@..@@@..@@...@.@@@@...@..@@@@@@@@..@...@@@....@@@..@....@@.@....@@.@@@@@.@@.@@@@@.@.@.@@@@@@.@"
"..@@@@@@..@.@@@@@@@@@.@@..@@@@@@@@..@..@@.@...@@@@.@..@@@@@.@.@.@@@@@@..@@@@@@@@@@@@@.@@@.@..@..@@@@..@@@@@@@@@.@.@.@@@..@@@@@.@.@@.@@@"
"@.@@@.@@@.@@@@@@.@@@.@@.@@.@@@.@@.@@@...@@@@.@.@.@@@@@.@@@.@.@@.@@@@..@.@.@@.@@.@@@@.@@..@@@..@.@@.@..@.@@..@@@@..@@.@@@@.@@@.@....@@@@"
"@.@@@@@.@@.@@@.@@@@@.@@@@.@.......@@@.@...@@.@@@@.@.@@@@@.@@@@@@.@@@@@..@.@@@.@.@@@@@@@@@@@@@@.@@.@@@@.@@@@@@.@.@..@.@.@@.@@...@.@.@@@."
"@@.@.@.@@@@@@@@@@@@@..@@@..@@@@@@....@@@..@.@@@.@@...@.@@@..@..@@..@@.@@@@.@..@.@.@@@@..@.@@.@@@@@.@@@@..@@@@.@@.@@@...@@.@@.@.@.@@...."
"@@@@@@...@@@.@.@@@@@....@@.@.@.@@@@@.@@@@.@@...@.@@.@@@@.@@..@@@.@@@.@@..@@@.@@@@@..@@.@@@@.@@@@.@..@.@@...@@@.@.@@@@.@.....@@@@@..@@@."
"@@@..@@@.@@@@.@.@.@@@@.@@.@@@.@@@@.@.@@.@@@@@.@@@@.@@.@...@@@@@@@@.@@@.@.@@@@@..@@@.@.@...@@@@@@@..@@.@@.@...@@@@@@@..@@@@@@.@...@@.@.@"
"@@@.@..@.@@@.....@@.@.@@@@...@.@@@@.@..@@@@@@@.@.@..@@@.@...@...@.@..@@@..@@.@@@@@@@@.@.@@@..@@@@@.@...@..@@@@@..@@.@@@.@@.@@@@@@@@.@@@"
"@@.@.@...@@.@..@@@@@..@@@@@@...@.@@.@...@@@@@@@@@@..@@@@..@@@@@@@.@@.@@@.@..@@.@@@.@.@@.@..@@@@@@@@..@.@@@@.@@@@@@@@@.@@@@@.@@.@.@.@@@@"
"@@.@.@@..@@...@@@@@..@.@@@.@..@@..@.@.@.@@@..@..@@.@.@@@@@@@@@@@......@@.@@@.@.@@@@.@.@@.@..@@@@.@.@@.@@@@@@.@.@.@@@.@@.@@@.@@.@@@.@.@@"
".@.@@@.@@@..@@.@..@.@.@@@.@..@@@@@@@.@@...@@@@.@@.@@.@@.@@@@@@.@.@@@...@@@@@.@......@@.@@@@@.@@..@.@@@...@@@.@@.@.@@@..@@@@..@.@.@@@.@@"
"@@.@@..@@@.@.@@.@@@@.@@@@..@..@@@.@@@.@@@..@@@@@.@..@@.@.@@.@@@@@.@.@..@.@@@@.@@@.@.@..@.@..@..@.@@@@..@.@.@@@@...@@.@.@.@..@@@@@@@.@@."
".@@@@@@@.@@@..@@@.@..@@.@..@@.@@@@@.@.@...@@.@.@.@@.@@@@.@@@@@@@@@@@@..@@@@@@@..@@.@@@@@.@..@@@@@@@.@@@@@@@@@..@@@@@.@@@@@@@@@@@@@@@.@@"
".@@.@.@...@@@@@@@..@.@..@@..@@..@...@@@@.@@@@@@..@.@@.@..@..@.@....@@@@@@@@@.@@.@...@@@.@.@@@@@..@@@@@@@@.@...@@@@@@..@@@@.@@@.@@@@@@.@"
"@@@..@.@.@..@.@@@..@@.@@@@..@.@.@@@.@@@@.@@@.@@.@@.@...@@@@..@..@...@.@.@..@@@@@@@@@.....@@@.@@@@.@@.@@@...@.@@@.....@.@@@@@@@@@...@.@."
".@.@.@@@@...@.@@...@@@@@@.@@@@.@....@@@.@@@@...@@@.@..@@..@@@@@..@@.@...@.@......@@.@@..@@@@..@@@..@@@..@@@.......@@@@@@@@@.@@.@@@@@.@."
"@@@@.@@..@@@@.@@@@@.@.@@@@@.@@.@@.@@@...@.@.@@@@@@@@@@@@..@@.@@..@@....@@.@@@@@.@@@@@@@@@.@@@.@.@@..@@@@...@..@@@@.@..@.....@@@@@@@..@@"
"@..@.@.@@@.@@.@..@@@.@@@@..@..@.@.@..@@@@@.@.@@@@@@.@@.@@@.@@@@..@@.@@@@@@@@@.@..@@@@..@.@...@.@....@..@@@.@@..@.@@..@.@@.@..@@..@@@@.@"
"@.@@@@@@@.@@@@....@@.@@.@@..@@@..@@..@@@@..@..@..@..@.@@@@@@@.@@@@@@@@...@@.@.@....@.@.@@@.@@..@@@...@@@@.@@@@@@@.@@@.@.@@@...@@@.@.@@."
"@@@.@@@@@.@.@..@.....@@@@@.@@@.@..@@@@@@@@@....@.@@@@@@@.@.@.@@@.@@@.@.@@.@@..@@@@..@@.@@.@.@....@@.@.@@@.@@@@@@....@@@@@@@@@.@.@@@@.@@"
"....@@@...@@@@@@@..@@@@..@.@@@.@@@@@@@@@@..@@.@@.@...@@@@....@@@@@@@@@.@.@..@@@@.@.@.@@..@@@.@@.@@.@@@@@@@@@@@@@..@.@@.@@@..@@.@.@@.@@@"
"@...@.@.@@@@@@@@@.@@@..@.@..@@......@@@@@..@..@.@..@.@@@@.@@.@@...@@..@@@@@@@@@@..@@.@..@.@@@..@@..@@.@..@.@@.@@@..@.@@@@.@@@@.@..@.@.@"
".@@@@.@.@@@@@.@.@.@.@..@@@...@@@@@@.@.@@@@.@..@.@@@@@..@@@@@..@@@..@@@@@.@@@@.@@.@.@@@@@@@@.@@.@.@.@@.@.@@@@@.@..@@@@@.@@@@@@@...@.@.@."
"@@@@@@.@@@@@@..@..@@@@@@@@@@@@@...@.@@...@.@@@@@@@.@@@.@..@.@@@@...@..@..@@.@@@@@@@.@.@@@@...@@.@@..@..@@.@...@@@@@@@@...@@@@@@@@@@@@@."
"@@@@..@@@..@.@.@@@.@..@@.@.@@@@@..@@@@@@@@.@@@@..@.@@@@@@..@@@@@@...@..@@.@@@@@..@@..@@@@@@@@@@@@@.@@@@@@.@@@.@.@@..@@.@@..@@@...@@@..."
"@@@@@@.@@@@@@@@@@@@@.@@@@@.@@@@..@@@@.@..@@@@@...@..@@.@@@@@@@@.@.@..@....@@@.@@@@@..@@..@@@.@@@......@...@@@.....@@.@@.@@@.@@@.@.@@@@@"
".@...@@@@@@.@@@@@..@@.@@...@@@@.@@.@@@..@@@@.@@..@@@@.@.@..@.@@.@@@.@@.@@..@@@.@@@@.@@.@@@.@@@.@@@@.@.@@@@.@.@@.@@.@@@@@...@.@.@@.@.@@@"
".@......@@@@@@@@@@@@@@@.@.@..@.@.@@.@@@.@....@@@.@@..@..@.@.@@@...@@.@.....@.@.@@@@@@@@@@@..@@@.@@.....@.@@.@@..@.@@@@.@@..@.@@.@.@@..@"
"@@...@..@..@@@.@..@@.@@@.@@@@@@.@@.@.@@@@@@.@@..@...@@.@@@..@@@@.@@.@@..@@.@@@@@@...@.@@@@.@@@..@@.@@@@.@@@@@@.@@..@..@@@@@@.@@@.@@.@.@"
".@@@@@@.@.@@@.@.@@....@@@.@@.@@@@@@@@@.@@.@@@@@..@..@....@.@.@@.@.....@@.@@@.@@....@@...@@@.@@@...@@@@@....@@@@....@@.@.@@@@.@@.@.@@.@@"
"@..@@@@@@@@@..@.@@..@@@@@..@@@@.@@@@.@..@@.@.@@@@@@@@@.@@@@...@.@.@@@.@@@@@@.@@@@@..@@@@@@@..@@.@...@@@@@..@@@@@@..@@@@@..@@.@@@@@@@.@."
"@@...@@..@@@.@@@..@..@@@....@..@...@@.@@.@@@.@.@@@@@@@@..@@@@@@..@@@.@..@..@.@@.@@@@.@@@@@@@@@@@.@.@@@@@@@@@..@@@@@....@@@@@@@@@@@....."
".@@.@.@@@@@@..@..@@@@.@@.@.@.@@..@@@@.@.@@@.@@@.@@@@.@@@@@.......@@@@@@@.@@@@@@..@@..@.@@@.@@@.@@@@.@@@@...@.@.@@@.@@@@......@@.@.@..@@"
"@@@@@@@@.@@@@.@@@@@@.@@..@@@@@@...@.@.@@.@@@@..@@@@....@...@.@@.@@.@@@@@.......@@@@@@@@@@.@..@....@@..@@@.@.@@.@@.@@..@@@@.@@@@@@.@@@.@"
".@@.@..@@.@.@@@.@@.@.@..@@@.@@@@@@@....@@.@.@..@@.@@@@@@@@@@@@@@.@@.@@@@.@.@@@.@@@.@@@..@@..@@.@@@@..@@@.@.@.@@.@@@@@@@@@@@@@@@.@@@.@@."
".@@.@@.@@@@@@..@@@@@@@@@@.@@@@.@@@.@...@@@..@@@..@..@@@@@@.@@.@@@@@@@..@@@.@@.@@@.@@..@@@....@@.@.@@@@.@..@..@@@@@...@@@@@@..@@@.@@@..."
"@@@@@@@@.....@.@@..@.@@.@@@.@...@.@@.@.@@@@.@@@@...@@@@@.@.@@@.@.@...@@@.@@@@.@@..@@.@..@@@@@..@@..@@@@@@@@@.@.@..@.@@....@.@@.@.@@@.@."
"@.@@@@@@@@..@@.@@@..@.@@@@@@@@.@@.@@@....@.@@@@@@@@@.@@.@.@.@..@@@.@..@@@..@@.@@...@@..@@@@.@.@.@@..@@.@@.@@@.@@@@@@@@....@@@@.@@.@@.@."
"@@@@@.@@@@.@@@@@.@@.@.@@@@@@@..@.@.@.@.@..@.@@.@@.@@@@@@.@@@@@@@.@@.@@@@@@.@@@.@@..@@.@...@@.@@@@.@@@..@@@@.@@@..@.@@.@@@..@@.@@@@@@.@@"
"@@.@..@@@@@.@@@..@@.@....@@@@@@.@.@@@@@.@@..@..@@@@.@@@@@@@.@@...@@..@@@@@@@@.@@@@.@@@@@.@@...@@@@.@@...@@@.@..@.....@@@.@.@@...@@@@@.@"
".@.@.@@.@@..@.@.@@@@@@@.@.@@@@@@@@@@@@.@@@..@@.@@@..@.@@@@.@@..@...@.@@.@...@.@@@@..@.@@@@...@@@.@.@@..@@@.@@@@..@@@@@@@@.@@.@@.@..@@@@"
"@@...@...@@.@@@@.@@.@..@@.@@@.@@@@@@.@.@@@@..@@@@@.@@.@@@@@@@@@.@.@@@..@.@@@.@..@....@.@..@@.@.@.@.@@@@.@@@.@@@@@@@@....@...@..@.@..@.@"
"@...@@@@@@@@@.@@@@@@@@@@@.@.@.@@.@@@.@@@@@@@@@@@..@..@@.@@@@.@@@.@.@@@@@.@@@.@.@@@@@.@@@@@@@@@@@.@.@@@@@@@@@.@@@@@@@...@.@@@@@@@@@@@@.."
".@@@@@.@.@@@@@.@@....@@@@@..@@@@.@@@.@@.@.@.@@...@@.@...@@.@.@@.@.@@@@@...@..@@@.@@@@....@.@@.@.@@@@@@@@@@@.@@@...@@.@@@@@.@@.@@@@@@..@"
"@..@.@..@.@@@@@..@.@@@@@@@.@@@@@.@.@@@@.@@@@@@@@@@@.@..@........@@@.@@.@.@.@@.@.@@.@@@@.@.@@@@@.@@@@@..@.@@....@@@@@@@@@..@@@@..@@@@.@@"
"@@..@.@@@@@.@.@@..@.@.@.@@@@.@@@@@...@@@...@@@..@.@@@@.@.@.@.@...@.@.@@@@@@@@..@@..@@@@@.@@.@..@@.@@..@.@@@....@@...@@@@.@@@@@@@@@.@@@@"
"@@@@@@@@@..@@@@.@@@.@@@..@@@@@.@@@@@@@..@@@@.@@@...@@@.@@.@.@.@@.@@......@@..@@@.@@@@@.@@..@@..@.@.@@@.@@@@@@@@.@....@..@@@@@@@@.@.@@.@"
"@@.@...@@@.@@@@.@@@.@@.@@@@.@@@@@.@.@@..@...@@.@@..@@@@@@..@.@.@@.@.@@.@.@@.@@.@@@.@@.@@...@@@@.@@.@.@.@@@.@...@..@@@@@@@.@....@..@@@.."
".@@.@@@@@@@@@.@.@.@@@@@..@@@@@@.@@@@@.@@@@@@.@@@.@@@@@@@.@..@@@@@@@.@@.@.@.@@..@@@@.@@@@@@.@@..@@.@@@...@@@.@@.@.@.@.@@..@@@@@@@.@.@@@@"
"@.@@@.@.@.@@@@.@@@@@.@@@@@@.@.@.@@@.@@@.@@@.@@.@.@.@.@@@@@.@@@.@.@@.@...@@@@@@@@@....@.@.@@..@...@@.@.@@@@@.@@...@@@@@@@.@@.@.@@@@@@@@@"
"@@@@@@.@.@@@@@..@@@.@@.@.@@...@@.@@@@@@...@@@@@@@...@@@.@@@@.@.@..@@@@@@@@@@..@@@..@@@@.@@..@.@..@.@@...@@@@@@@@@.@@@@@.@.@.@@.@@..@@@."
"@@@@@@@@..@@@@@@@@@@@..@.@.@@@@@@@.@...@@@.@.@@@@.@@@...@@@.@@@@@@@..@@@@@@@@@@.@@@@@@@@.@@..@.@.@@@.@.@@..@@@...@@@@@@.@..@@@.@.@@@@@@"
"@..@@.@@.@@.@@@.@.@..@@.@@@@@@.@@@@@.@@@@@..@..@.@.@.@@.@@@.@@@.@@.@@@@.@.@.@.@@@@@@@@@@@....@@@@.@@@@@@@@@@..@@...@@..@..@@.@.@@@@.@.."
".@@@@@@@.@....@@.@@@.@@@@..@@@.@@.@.@@@@.@.@@..@@@@@@@@@@.@..@@@@@..@@.@.@.@@.@@@@...@..@.@.@@@@@.@@..@@.@@@.@.....@@@@.....@@@@.@@@@.@"
))

; my take on a generic scheme aoc grid library
; design decisions: standard scheme list and pairs code
(define (point r c) (cons r c))
(define (point-r point) (car point))
(define (point-c point) (cdr point))
(define (point+ p1 p2) (point (+ (point-r p1) (point-r p2)) (+ (point-c p1) (point-c p2))))
(define (grid-height grid) (length grid))
(define (grid-width grid) (length (car grid)))
(define (grid-ref grid point) (list-ref (list-ref grid (point-r point)) (point-c point)))
(define grid-directions8 '((-1 . -1) (-1 . 0) (-1 . 1) (0 . -1) (0 . 1) (1 . -1) (1 . 0) (1 . 1)))
(define (grid-in-bounds? grid point)
  (let ((r (point-r point)) (c (point-c point)))
    (and (>= r 0) (>= c 0) (< r (grid-height grid)) (< c (grid-width grid)))))
(define (grid-neighbors grid directions point)
  (filter
    (lambda (point) (grid-in-bounds? grid point))
    (map (lambda (direction) (point+ point direction)) directions)))
(define (grid-points grid)
  (append-map
    (lambda (r) (map (lambda (c) (point r c)) (iota (grid-width grid))))
    (iota (grid-height grid))))

; used to test the library functions
;(display grid) (newline)
;(display (grid-ref grid '(0 . 0))) (newline)
;(display (grid-ref grid '(0 . 1))) (newline)
;(display (grid-ref grid '(0 . 2))) (newline)
;(display (grid-in-bounds? grid '(-1 . 0))) (newline)
;(display (grid-in-bounds? grid '(0 . 0))) (newline)
;(display (grid-in-bounds? grid '(0 . 10))) (newline)
;(display (grid-neighbors grid grid-directions8 '( 0 . 0))) (newline)
;(display (grid-points grid)) (newline)

; implementation of today using above library functions
(define grid (map string->list input))
(define rolls
  (filter
    (lambda (point) (char=? (grid-ref grid point) #\@))
    (grid-points grid)))

(define (<4-neighbor-rolls rolls)
  (filter
    ;(lambda (point) (< (length (filter (lambda (point) (char=? (grid-ref grid point) #\@)) (grid-neighbors grid grid-directions8 point))) 4))
    (lambda (x) (< (length (filter
			     (lambda (y) (member y rolls))
			     (grid-neighbors grid grid-directions8 x))) 4))
    rolls))

(display (length (<4-neighbor-rolls rolls))) (newline)

; part2
(define part2-rolls
  (let loop ((state rolls)
	     (acc '()))
    (let ((result (filter
		    (lambda (x) (< (length (filter
					     (lambda (y) (member y state))
					     (grid-neighbors grid grid-directions8 x))) 4))
		    state)))
      (if (= (length result) 0)
	(reverse acc)
	(loop
	  (filter (lambda (point) (not (member point result))) state)
	  (append acc result))))))

(display (length part2-rolls)) (newline)



